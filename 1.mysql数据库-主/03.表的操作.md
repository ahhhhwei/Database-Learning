# 03.表的操作

## 一、创建表

### 1.语法

```sql
CREATE TABLE table_name (
	field1 datatype,
	field2 datatype,
	field3 datatype
) character set 字符集 collate 校验规则 engine 存储引擎;
```

建表时，最后一行可以省略，因为表是在库里建的，字符集，校验规则等若缺省，则按库的来。

`field1 datatype`，名字在左，类型在右。

- 说明：
  - `field` 表示列名
  - `datatype` 表示列的类型
  - `character set` 字符集，如果没有指定字符集，则以所在数据库的字符集为准
  - `collate` 校验规则，如果没有指定校验规则，则以所在数据库的校验规则为准

### 2.创建表案例

```sql
create table if not exists `users` (
id int comment '用户的id值',
name varchar(20) comment '用户的姓名',
password varchar(32) comment '用户的登录密码',
birthday date comment '用户的生日'
) character set utf8 collate utf8_general engine MyISAM;
```

## 二、查看表

### 1.查看当前数据库中有哪些表

```sql
mysql> show tables;
+-------------------+
| Tables_in_ahweiDB |
+-------------------+
| users             |
+-------------------+
1 row in set (0.00 sec)
```

### 2.查看表结构

```sql
desc  表名
```

```sql
mysql> desc users;
+----------+-------------+------+-----+---------+-------+
| Field    | Type        | Null | Key | Default | Extra |
+----------+-------------+------+-----+---------+-------+
| id       | int         | YES  |     | NULL    |       |
| name     | varchar(20) | YES  |     | NULL    |       |
| password | varchar(32) | YES  |     | NULL    |       |
| birthday | date        | YES  |     | NULL    |       |
+----------+-------------+------+-----+---------+-------+
4 rows in set (0.01 sec)
```

![image-20230418182018980](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418182018980.png)

### 3.查看创建表时的sql语句

```sql
mysql> show create table users;
+-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table | Create Table                                                                                                                                                                                                                                                                                            |
+-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| users | CREATE TABLE `users` (
  `id` int DEFAULT NULL COMMENT '用户的id值',
  `name` varchar(20) DEFAULT NULL COMMENT '用户的姓名',
  `password` varchar(32) DEFAULT NULL COMMENT '用户的密码',
  `birthday` date DEFAULT NULL COMMENT '用户的生日'
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb3                    |
+-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

> 把`;`换成`\G`显示更加整洁
>
> ```sql
> mysql> show create table users\G
> *************************** 1. row ***************************
>        Table: users
> Create Table: CREATE TABLE `users` (
>   `id` int DEFAULT NULL COMMENT '用户的id值',
>   `name` varchar(20) DEFAULT NULL COMMENT '用户的姓名',
>   `password` varchar(32) DEFAULT NULL COMMENT '用户的密码',
>   `birthday` date DEFAULT NULL COMMENT '用户的生日'
> ) ENGINE=MyISAM DEFAULT CHARSET=utf8mb3
> 1 row in set (0.00 sec)
> ```

### 4.表的物理结构与逻辑结构

表的逻辑结构：

![image-20230418181204276](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418181204276.png)

表的物理结构：

![image-20230418181244500](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418181244500.png)

## 三、修改表

在项目实际开发中，经常修改某个表的结构，比如字段名字，字段大小，字段类型，表的字符集类型，表的存储引擎等等。我们还有需求，添加字段，删除字段等等。这时我们就需要修改表。

我们先往表中插入一些值

```sql
mysql> select * from users;
+------+--------+----------+------------+
| id   | name   | password | birthday   |
+------+--------+----------+------------+
|    1 | 阿伟   | 000000   | 2023-04-18 |
|    2 | 啊喂   | 111111   | 1000-10-01 |
+------+--------+----------+------------+
2 rows in set (0.00 sec)
```

- 新增一列

  ```sql
  mysql> alter table users add image_path varchar(128) comment '这个是用户头像图片的路径' ;
  Query OK, 2 rows affected (0.03 sec)
  Records: 2  Duplicates: 0  Warnings: 0
  ```

  ![image-20230418183403156](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418183403156.png)

  这时发现，建表语句已变成：

  ```sql
  mysql> show create table users\G
  *************************** 1. row ***************************
         Table: users
  Create Table: CREATE TABLE `users` (
    `id` int DEFAULT NULL COMMENT '用户的id值',
    `name` varchar(20) DEFAULT NULL COMMENT '用户的姓名',
    `password` varchar(32) DEFAULT NULL COMMENT '用户的密码',
    `birthday` date DEFAULT NULL COMMENT '用户的生日',
    `image_path` varchar(128) DEFAULT NULL COMMENT '这个是用户头像图片的路径'
  ) ENGINE=MyISAM DEFAULT CHARSET=utf8mb3
  1 row in set (0.00 sec)
  ```

  指定在哪里插入：

  ```sql
  mysql> alter table users add sex char(2) after name;
  Query OK, 2 rows affected (0.04 sec)
  Records: 2  Duplicates: 0  Warnings: 0
  ```

  ![image-20230418184023873](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418184023873.png)

  建表语句：

  ```sql
  mysql> show create table users\G
  *************************** 1. row ***************************
         Table: users
  Create Table: CREATE TABLE `users` (
    `id` int DEFAULT NULL COMMENT '用户的id值',
    `name` varchar(20) DEFAULT NULL COMMENT '用户的姓名',
    `sex` char(2) DEFAULT NULL,
    `password` varchar(32) DEFAULT NULL COMMENT '用户的密码',
    `birthday` date DEFAULT NULL COMMENT '用户的生日',
    `image_path` varchar(128) DEFAULT NULL COMMENT '这个是用户头像图片的路径'
  ) ENGINE=MyISAM DEFAULT CHARSET=utf8mb3
  1 row in set (0.00 sec)
  ```

- 调整表的列属性

  ```sql
  mysql> alter table users modify name varchar(60);
  Query OK, 2 rows affected (0.04 sec)
  Records: 2  Duplicates: 0  Warnings: 0
  ```

  ![image-20230418184842658](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418184842658.png)

  查看建表sql语句：发现`name`的类型不仅变成了`varchar(60)`，而且后面的`comment`也被覆盖掉了。

  ```sql
  mysql> show create table users\G
  *************************** 1. row ***************************
         Table: users
  Create Table: CREATE TABLE `users` (
    `id` int DEFAULT NULL COMMENT '用户的id值',
    `name` varchar(60) DEFAULT NULL,
    `sex` char(2) DEFAULT NULL,
    `password` varchar(32) DEFAULT NULL COMMENT '用户的密码',
    `birthday` date DEFAULT NULL COMMENT '用户的生日',
    `image_path` varchar(128) DEFAULT NULL COMMENT '这个是用户头像图片的路径'
  ) ENGINE=MyISAM DEFAULT CHARSET=utf8mb3
  1 row in set (0.00 sec)
  ```

- 删除表中的某一列

  ```sql
  mysql> alter table users drop id;
  Query OK, 2 rows affected (0.02 sec)
  Records: 2  Duplicates: 0  Warnings: 0
  ```

  ![image-20230418185459743](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418185459743.png)

  把`name`,`sex`,`password`, `birthday`四列都删掉：

  ![image-20230418185822366](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418185822366.png)

  尝试删除`image_path`这一列：

  ![image-20230418185924855](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418185924855.png)

  只剩下一列时不能再删除了。如果要删，就删除整张表。

- 修改表列名字

  ![image-20230418190408396](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418190408396.png)

  ```sql
  mysql> alter table users change image_path path varchar(128) comment '路径';
  Query OK, 0 rows affected (0.03 sec)
  Records: 0  Duplicates: 0  Warnings: 0
  ```

  ![image-20230418190424270](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418190424270.png)

- 修改表名

  ```sql
  mysql> alter table users rename user_set;
  Query OK, 0 rows affected (0.04 sec)
  ```

  ![image-20230418190732714](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418190732714.png)

  `rename`后也可以加`to`：

  ```sql
  mysql> alter table user_set rename to users;
  Query OK, 0 rows affected (0.03 sec)
  ```

  ![image-20230418190931376](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230418190931376.png)

## 四、删除表

### 1.语法

```sql
DROP [TEMPORARY] TABLE [IF EXISTS] tbl_name [, tbl_name] ...
```

```sql
mysql> drop table students, users;
Query OK, 0 rows affected (0.05 sec)
```

```sql
mysql> show tables;
Empty set (0.00 sec)
```

