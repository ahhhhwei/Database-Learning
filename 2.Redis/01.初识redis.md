# 01.初识redis

## 一、Redis简介

**Redis** 是一种开源的 **内存** 数据结构存储系统，它可以用作数据库、缓存和消息中间件。如果只是单机程序，直接通过变量存储数据的方式，是比使用 redis 更优的选择。如果是分布式系统，想访问到其他进程的变量是非常困难的（进程的隔离性），redis 相当于针对上述需求点做了封装。**redis就是基于网络，可以把自己内存中的变量给别的进程，甚至别的主机的进程进行使用。**

- Mysql：访问速度慢
- Redis：作为数据库使用，访问速度快，但是存储空间有限
- 又大又快：最典型的方案，可以把 redis 和 MySQL 结合起来使用（用 redis 作为 MySQL 的 cache），把热点数据用 redis 来存储，把全量数据还是用 MySQL 来存储。（“二八原则”，即20%的热点数据满足80%的访问需求）。但是系统的复杂程度大大提升了，而且，当涉及到数据更新时，还需处理好 Redis 与后端数据库之间的同步问题，确保数据一致性。

虽然 Redis 最初设计目的是为了实现消息中间件（分布式系统下的生产者消费者模型）功能，但在现代分布式系统中，专门的消息队列产品（如RabbitMQ、Kafka等）往往更适合承担这一角色。

## 二、关于分布式

### 1.单机架构

单机架构，只有一台服务器，这个服务器负责所有的工作

![单机架构](./pic/1-单机架构.svg)

单机程序中，能不能把数据服务器也去掉，光一个应用服务器又负责业务，又负责数据存储？（也不是不可以，但是就是会比较麻烦）

千万不要瞧不上这个东西，绝大部分公司的产品，都是这种单机架构！

现在的计算机硬件，发展速度非常之快，哪怕只有一台主机，这一台主机的性能也是很高的，可以支持非常高的并发和非常大的数据存储。

### 2.分布式架构

如果业务进一步增长，用户量和数据量都水涨船高，一台主机难以应付的时候，就需要引入更多的主机，引入更多的硬件资源。

一台主机的硬件资源是有上限的！！！包括但不限于一下几种（1.CPU 2.内存 3.硬盘 4.网络 5. …）服务器每次收到一个请求，都是需要消耗上述的一些资源的。如果同一时刻处理的请求多了，此时就可能会导致某个硬件资源不够用了。无论是哪个方面不够用了，都可能会导致服务器处理请求的时间变长，甚至于处理出错。

如果遇到了这样的服务器不够用的场景，该怎么处理。

- 开源——简单粗暴增加更多的硬件资源，但是一个主机上面能增加的硬件资源是有限的，取决于主板的扩展能力。一台主机扩展到极限了，但是还不够，就只能引入多台主机了。（不是说新的机器买来就可以解决问题了，也需要软件上做出对应的调整和适配）一旦引入多台主机了，系统就可以称为分布式系统了。**引入分布式，这是万不得已**，系统的复杂程度会大大提高
- 节流——软件上优化（各凭本事，需要通过性能测试，找到是哪个环节出了瓶颈，再去对症下药），但这对于程序员的水平要求较高

应用服务和数据库服务分离：

![双机架构](./pic/1-双机架构.png)

![三机架构](./pic/1-三机架构.png)

负载均衡器，看起来不是承担了所有的请求嘛？这个东西能顶住嘛？

负载均衡器，对于请求量的承担能力，要远远超过应用服务器的。那是否可能会出现，请求量大到负载均衡器也扛不住了呢？也是有可能的，这时候就要引入更多的负载均衡器（引入多个机房）。



入上面讨论，增加应用服务器，确实能够处理更高的请求量。但随之存储服务器要承担的请求量也就更多了！

——引入更多的机器

![image-20230709162950035](C:\Users\20848\AppData\Roaming\Typora\typora-user-images\image-20230709162950035.png)

数据库天然有个问题，响应速度比较慢！

把数据区分**冷热**，热点数据放到缓存中，缓存的访问速度往往比数据库要快很多了！

引入分布式系统，不光要能够去应对更高的请求量（并发量），同时也要能应对更大的数据量。

一台服务器存不下数据时，就用多台主机来存储。

针对数据库进一步的拆分——分库分表

本来一个数据库服务器，这个数据库服务器上有多个数据库（指的是逻辑上的数据集合，create database 创建的那个东西）。现在就可以引入多个数据库服务器，每个数据库服务器存储一个或者一部分数据库